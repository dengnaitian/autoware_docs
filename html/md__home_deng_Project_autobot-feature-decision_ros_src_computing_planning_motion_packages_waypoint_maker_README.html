<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Autoware_Doxygen: waypoint_maker</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Autoware_Doxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_deng_Project_autobot-feature-decision_ros_src_computing_planning_motion_packages_waypoint_maker_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespacewaypoint__maker.html">waypoint_maker</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<ul>
<li>This package has following nodes.<ul>
<li>waypoint_clicker</li>
<li>waypoint_saver</li>
<li>waypoint_extractor</li>
<li>waypoint_marker_publisher</li>
<li>waypoint_loader</li>
<li>waypoint_replanner</li>
<li>waypoint_velocity_visualizer</li>
</ul>
</li>
<li><p class="startli">3-formats of waypoints.csv handled by <a class="el" href="namespacewaypoint__maker.html">waypoint_maker</a></p><ul>
<li>ver1： consist of x, y, z, velocity（no velocity in the first line）</li>
</ul>
<p class="startli">ex)</p>
<p class="startli">&gt; 3699.6206,-99426.6719,85.8506 <br />
 &gt; 3700.6453,-99426.6562,85.8224,3.1646 <br />
 &gt; 3701.7373,-99426.6250,85.8017,4.4036 <br />
 &gt; 3702.7729,-99426.6094,85.7969,4.7972 <br />
 &gt; 3703.9048,-99426.6094,85.7766,4.7954 <br />
 &gt; 3704.9192,-99426.5938,85.7504,4.5168 <br />
 &gt; 3705.9497,-99426.6094,85.7181,3.6313 <br />
 &gt; 3706.9897,-99426.5859,85.6877,4.0757 <br />
 &gt; 3708.0266,-99426.4453,85.6608,4.9097 <br />
 &gt; ... <br />
</p><ul>
<li>ver2： consist of x, y, z, yaw, velocity（no velocity in the first line）</li>
</ul>
<p class="startli">ex)</p>
<p class="startli">&gt; 3804.5657,-99443.0156,85.6206,3.1251 <br />
 &gt; 3803.5195,-99443.0078,85.6004,3.1258,4.8800 <br />
 &gt; 3802.3425,-99442.9766,85.5950,3.1279,7.2200 <br />
 &gt; 3801.2092,-99442.9844,85.5920,3.1293,8.8600 <br />
 &gt; 3800.1633,-99442.9688,85.5619,3.1308,10.6000 <br />
 &gt; 3798.9702,-99442.9609,85.5814,3.1326,10.5200 <br />
 &gt; 3796.5706,-99442.9375,85.6056,3.1359,10.2200 <br />
 &gt; 3795.3232,-99442.9453,85.6082,3.1357,11.0900 <br />
 &gt; 3794.0771,-99442.9375,85.6148,3.1367,11.2300 <br />
 &gt; ... <br />
</p><ul>
<li>ver3： category names are on the first line</li>
</ul>
<p class="startli">ex） consist of x,y,z,yaw,velocity,change_flag</p>
<p class="startli">&gt; x,y,z,yaw,velocity,change_flag <br />
 &gt; 3742.216,-99411.311,85.728,3.141593,0,0 <br />
 &gt; 3741.725,-99411.311,85.728,3.141593,10,0 <br />
 &gt; 3740.725,-99411.311,85.733,3.141593,10,0 <br />
 &gt; 3739.725,-99411.311,85.723,3.141593,10,0 <br />
 &gt; 3738.725,-99411.311,85.719,3.141593,10,0 <br />
 &gt; 3737.725,-99411.311,85.695,3.141593,10,0 <br />
 &gt; 3736.725,-99411.311,85.667,3.141593,10,0 <br />
 &gt; 3735.725,-99411.311,85.654,3.141593,10,0 <br />
 &gt; ... <br />
</p>
</li>
</ul>
<h2>Nodes</h2>
<h3>waypoint_loader</h3>
<ol type="1">
<li>Overview<ul>
<li>waypoint_loader<ul>
<li>Convert waypoints.csv to ROS message type.</li>
<li>Correspond to the above 3 types of csv.</li>
</ul>
</li>
<li>waypoint_replanner<ul>
<li>Adjust waypoints offline (resample and replan velocity)</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li>How to use<ul>
<li>How to start<ul>
<li>At <code>Computing</code>-&gt;<code>waypoint_loader</code>:<ul>
<li>Check app-&gt;<code>load csv</code>. If you want to load csv_files, switch to true. Otherwise switch to false.</li>
<li>Check <code>waypoint_loader</code> and start.</li>
</ul>
</li>
</ul>
</li>
<li>Idea of velocity replanning<ul>
<li>The velocity plan is based on the following idea.<ul>
<li>On a straight line, it accelerates to the maximum speed.</li>
<li>At one curve:<ul>
<li>Finish decelerating before entering the curve. If the curve is sharper, the more deceleration is required.</li>
<li>Maintain a constant speed in the curve.</li>
<li>Start to accelerate after getting out of the curve.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Detail of app tab<ul>
<li>On <code>multi_lane</code>, please select multiple input files. If you want lane change with <code>lane_select</code>, prepare ver3 type.</li>
<li>Check <code>replanning_mode</code> if you want to replan velocity.<ul>
<li>On replanning mode:<ul>
<li>Check <code>realtime_tuning_mode</code> if you want to tune waypoint.</li>
<li>Check <code>resample_mode</code> if you want to resample waypoints. On resample mode, please set <code>resample_interval</code>.</li>
<li>Velocity replanning parameter<ul>
<li>Check <code>replan curve mode</code> if you want to decelerate on curve.</li>
<li>Check <code>overwrite vmax mode</code> if you want to overwrite velocity of all waypoint.</li>
<li>Check <code>replan endpoint mode</code> if you want to decelerate on endpoint.</li>
<li><code>Vmax</code> is max velocity.</li>
<li><code>Rth</code> is radius threshold for extracting curve in waypoints. Increasing this, you can extract curves more sensitively.</li>
<li><code>Rmin</code> and <code>Vmin</code> are pairs of values used for velocity replanning. Designed velocity plan that minimizes velocity in the assumed sharpest curve. In the <em>i</em>-th curve, the minimum radius <em>r<sub>i</sub></em> and the velocity <em>v<sub>i</sub></em> are expressed by the following expressions. <em>v<sub>i</sub></em> = <em>Vmax</em> - _(Vmax - Vmin)/(Rth - Rmin)_ * _(Rth - r<sub>i</sub>)_</li>
<li><code>Accel limit</code> is acceleration value for limitting velocity.</li>
<li><code>Decel limit</code> is deceleration value for limitting velocity.</li>
<li><code>Velocity Offset</code> is offset amount preceding the velocity plan.</li>
<li><code>Braking Distance</code> is the number of minimum velocity before end point offset.</li>
<li><code>End <a class="el" href="struct_point.html">Point</a> Offset</code> is the number of 0 velocity points at the end of waypoints.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li>Subscribed Topics<ul>
<li>waypoint_replanner<ul>
<li>/based/lane_waypoints_raw (autoware_msgs/LaneArray)</li>
<li>/config/waypoint_replanner (autoware_config_msgs/ConfigWaypointReplanner)</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li>Published Topics<ul>
<li>waypoint_loader<ul>
<li>/based/lane_waypoints_raw (autoware_msgs/LaneArray)</li>
</ul>
</li>
<li>waypoint_replanner<ul>
<li>/based/lane_waypoints_array (autoware_msgs/LaneArray)</li>
<li>/lane_waypoints_array (autoware_msgs/LaneArray)</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li><a class="el" href="union_parameters.html">Parameters</a><ul>
<li>waypoint_loader<ul>
<li>~multi_lane_csv</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3>waypoint_saver</h3>
<ol type="1">
<li>Overview<ul>
<li>waypoint_saver<ul>
<li>When activated, subscribe <code>/current_pose</code>, <code>/current_velocity</code>(option) and save waypoint in the file at specified intervals.</li>
</ul>
</li>
<li>waypoint_extractor<ul>
<li>When activated, subscribe autoware_msgs/LaneArray and save waypoint in the file. Input topic name is selectable.</li>
</ul>
</li>
<li>common<ul>
<li><code>change_flag</code> is basically stored as 0 (straight ahead), so if you want to change the lane, edit by yourself. (1 turn right, 2 turn left)</li>
<li>This node corresponds to preservation of ver3 format.</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li><p class="startli">How to use</p>
<p class="startli">On app:</p><ul>
<li>common<ul>
<li>Ref on the <code>Save <a class="el" href="class_file.html">File</a></code> and specify the save file name.</li>
<li>Select the function you want to use from the <code>Input Type</code>.</li>
</ul>
</li>
<li>if <code>Input Type</code> == VehicleFootprint (<code>waypoint_saver</code>)<ul>
<li>Check <code>Save/current_velocity</code> if you want to save velocity. In otherwise, saved as 0 velocity.</li>
<li>Using <code>Interval</code>, it is set how many meters to store waypoint.</li>
</ul>
</li>
<li>if <code>Input Type</code> == LaneArrayTopic (<code>waypoint_extractor</code>)<ul>
<li>Set lane_array topic name you want to save.</li>
<li>Cache starts at the same time as the node starts up.</li>
<li>The cache is always overwritten while the node is running.</li>
<li>The cache is flushed when the node is closed.</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li>Subscribed Topics<ul>
<li>waypoint_saver<ul>
<li>/current_pose (geometry_msgs/PoseStamped) : default</li>
<li>/current_velocity (geometry_msgs/TwistStamped) : default</li>
</ul>
</li>
<li>waypoint_extractor<ul>
<li>/lane_waypoints_array (autoware_msgs/LaneArray) : default</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol type="1">
<li>Published Topics<ul>
<li>nothing</li>
</ul>
</li>
</ol>
<ol type="1">
<li><a class="el" href="union_parameters.html">Parameters</a><ul>
<li>waypoints_saver<ul>
<li>~save_filename</li>
<li>~interval</li>
<li>~velocity_topic</li>
<li>~pose_topic</li>
<li>~save_velocity</li>
</ul>
</li>
<li>waypoints_extractor<ul>
<li>~lane_csv</li>
<li>~lane_topic </li>
</ul>
</li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
