<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Autoware_Doxygen: ndt_matching_monitor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Autoware_Doxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_deng_Project_autobot-feature-decision_ros_src_computing_perception_localization_packages_lidar_localizer_nodes_ndt_matching_monitor_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ndt_matching_monitor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Simple health monitoring and reinitialization for <code>ndt_matching</code> localization node of <a href="https://github.com/CPFL/Autoware">Autoware</a></p>
<h2>Introduction</h2>
<p><code>ndt_matching</code> publishes the current robot/vehicle position in the <code>/ndt_pose</code> topic and statistics in the <code>/ndt_stat</code> topic, such as score, execution time.</p>
<p>The score is the result of PCL's function <code>getFitnessScore()</code> which measures how well an input point cloud matches the reference pointcloud, in other words the alignment error between the input scan and the reference map. This value can be used to infer the reliability of NDT.</p>
<p><code>ndt_matching_monitor</code> subscribes to <code>/ndt_stat</code> and <code>/ndt_pose</code> topics, and keeps a running average filter on the score value. When the filtered score is beyond some thresholds, <code>ndt_matching_monitor</code> will issue the <code>/initialpose</code> topic (same as rviz) using the last known "healty" pose to force <code>/ndt_matching</code> to initialize.</p>
<p>If a GNSS device is available, an automatic reinitialization will be triggered with it. <code>nmea2pose</code> node is required. Otherwise, a halt in localization will be started. To reset the halted status, use <em>Initial Pose</em> tool in RVIZ.</p>
<h3>How to launch</h3>
<ul>
<li>From a sourced terminal:\ <code>roslaunch lidar_localizer ndt_matching_monitor.launch</code></li>
<li>From Runtime manager:\ Computing Tab -&gt; lidar_localizer -&gt; ndt_matching_monitor</li>
</ul>
<h3><a class="el" href="union_parameters.html">Parameters</a> available</h3>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Type</th><th>Description  </th></tr>
<tr>
<td><code>iteration_threshold_warn</code></td><td>*integer* </td><td>Number of maximum iterations before notifying a warning. Default 10. </td></tr>
<tr>
<td><code>iteration_threshold_stop</code></td><td>*integer*</td><td>Number of maximum iterations before notifying a warning. Default 32. </td></tr>
<tr>
<td><code>score_delta_threshold</code></td><td>*double*</td><td>Difference between consecutive scores to consider a safe match. Default 14.0 </td></tr>
<tr>
<td><code>min_stable_samples</code></td><td>*integer*</td><td>Minimum number of samples to start monitoring after a reset. Default 30 </td></tr>
<tr>
<td><code>fatal_time_threshold</code></td><td>*double*</td><td>When no GNSS is available a prediction based on the previous samples will be employed. If reinitialization fails the algorithm will stop after n secs. Default 2 </td></tr>
</table>
<h3>Subscribed topics</h3>
<table class="doxtable">
<tr>
<th>Topic</th><th>Type</th><th>Objective  </th></tr>
<tr>
<td><code>ndt_stat</code></td><td><code>autoware_msgs/ndt_stat</code></td><td>Obtain NDT statistics: <code>score</code>, <code>iterations</code>. </td></tr>
<tr>
<td><code>ndt_pose</code></td><td><code>geometry_msgs/PoseStamped</code></td><td>Obtain pose as calculated by <code>ndt_matching_node</code>. </td></tr>
<tr>
<td><code>initialpose</code></td><td><code>geometry_msgs/PoseWithCovarianceStamped</code></td><td>Obtain pose from RVIZ to reinitialize in case of an unrecoverable error. </td></tr>
<tr>
<td><code>gnss_pose</code></td><td><code>geometry_msgs/Pose</code></td><td>If a GNSS device is available it will be used to automatically try to reset NDT, requires <code>nmea2tfpose</code>. </td></tr>
</table>
<h3>Published topics</h3>
<table class="doxtable">
<tr>
<th>Topic</th><th>Type</th><th>Objective  </th></tr>
<tr>
<td><code>initialpose</code></td><td><code>geometry_msgs/PoseWithCovarianceStamped</code></td><td>Used to cause a reset or halt in <code>ndt_matching</code>. </td></tr>
<tr>
<td><code>/ndt_monitor/ndt_info_text</code></td><td><code>jsk_rviz_plugins/OverlayText</code></td><td>Publishes the text to be displayed in RVIZ with the help of <code>OverlayText</code> display type. </td></tr>
<tr>
<td><code>/ndt_monitor/ndt_status</code></td><td><code>std_msgs/String</code></td><td>Publishes the text for its later use in safety decision maker. </td></tr>
</table>
<h2>Contributing</h2>
<p><code>ndt_matching_monitor</code> is far from complete. For instance, the last known "healthy" pose stated above is just the last <code>/ndt_pose</code> value. A Kalman or particle filter might be used to improve this node. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
